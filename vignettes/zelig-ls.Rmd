---
title: "Least Squares Regression for Continuous Dependent Variables with `ls`"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Least squares regression with ls}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

*Built using Zelig version `r packageVersion('Zelig')`*

```{r setup, include=FALSE}
knitr::opts_knit$set(
        stop_on_error = 2L
)
```

Use least squares regression analysis to estimate the best linear
predictor for the specified dependent variables.

# Syntax

With Zelig 5 reference classes:

```{r, eval = FALSE}
z5 <- zls$new()
z5$zelig(Y ~ X1 + X ~ X, weights = w, data = mydata)
z5$setx()
z5$sim()
```

With the Zelig 4 compatibility wrappers:

```{r, eval = FALSE}
z.out <- zelig(Y ~ X1 + X2, model = "ls", weights = w, data = mydata)
x.out <- setx(z.out)
s.out <- sim(z.out, x = x.out)
```

# Examples

## Simple first differences

Load Zelig and attach example data frame:

```{r}
library(Zelig)
data(macro)
```

Estimate model:

```{r message=FALSE}
z.out1 <- zelig(unem ~ gdp + capmob + trade, model = "ls", data = macro, 
                cite = FALSE)
```

Summarize regression coefficients:

```{r, eval = TRUE}
summary(z.out1)
```

Set explanatory variables to their default (mean/mode) values, with
high (80th percentile) and low (20th percentile) values for the trade
variable:

```{r, eval = TRUE}
x.high <- setx(z.out1, trade = quantile(macro$trade, 0.8))
x.low <- setx(z.out1, trade = quantile(macro$trade, 0.2))
```

Simulate first differences for the effect of high versus low trade on GDP:

```{r, eval = TRUE}
s.out1 <- sim(z.out1, x = x.high, x1 = x.low)

summary(s.out1)
```

Plot the simulated distributions:

```{r}
#plot(s.out1)
#s.out1$graph()
```

## Using categorical variables, including fixed effects

Estimate a model with fixed effects for each country (see for help
with dummy variables). Note that you do not need to create dummy
variables, as the program will automatically parse the unique values
in the selected variable into discrete levels.

```{r}
z.out2 <- zelig(unem ~ gdp + trade + capmob + as.factor(country), model = "ls", 
                data = macro)
```

Set values for the explanatory variables, using the default mean/mode
values, with country set to the United States and Japan,
respectively:

```{r}
x.US <- setx(z.out2, country = "United States")
x.Japan <- setx(z.out2, country = "Japan")
```

Simulate quantities of interest and plot results:

```{r}
s.out2 <- sim(z.out2, x = x.US, x1 = x.Japan)

#plot(s.out2)
```

# Model Definition

-  The *stochastic component* is described by a density with mean
   $\mu_i$ and the common variance $\sigma^2$

   $$Y_i \; \sim \; f(y_i \mid \mu_i, \sigma^2).$$

-  The *systematic component* models the conditional mean as

   $$\mu_i =  x_i \beta,$$

   where $x_i$ is the vector of covariates, and $\beta$ is
   the vector of coefficients.

   The least squares estimator is the best linear predictor of a
   dependent variable given $x_i$, and minimizes the sum of
   squared residuals, $\sum_{i=1}^n (Y_i-x_i \beta)^2$.